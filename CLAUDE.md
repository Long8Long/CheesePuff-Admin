# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a **Shadcn UI-based** admin dashboard project using **Feature-Based Architecture**.

**Core Tech Stack:**
- **Framework**: React 19 + TypeScript
- **Build Tool**: Vite 7
- **Routing**: TanStack Router
- **Data Fetching**: TanStack Query
- **State Management**: Zustand
- **UI Components**: Shadcn UI (Radix UI + Tailwind CSS v4)
- **Forms**: React Hook Form + Zod
- **Auth**: Custom JWT (partial implementation)

## Common Commands

```bash
# Development
pnpm run dev              # Start development server

# Build
pnpm run build           # TypeScript compilation + production build
pnpm run preview         # Preview production build

# Code Quality
pnpm run lint            # ESLint code check
pnpm run format          # Prettier format code
pnpm run knip            # Analyze unused exports/dependencies

# Docker
docker build -t cheesepuff-admin:latest .    # Build Docker image
docker run -p 8080:80 cheesepuff-admin:latest # Run container
```

## Project Architecture

### Directory Structure

```
src/
├── components/
│   ├── ui/                    # Shadcn UI base components (32 components)
│   ├── data-table/            # Reusable data table components
│   ├── layout/                # Layout components (sidebar, header, nav)
│   └── *.tsx                  # Other business components
├── features/                  # Organized by feature modules
│   ├── dashboard/
│   ├── users/
│   ├── settings/
│   ├── auth/
│   ├── tasks/
│   ├── apps/
│   └── chats/
├── routes/                    # TanStack Router routes
│   ├── (auth)/               # Authentication pages
│   ├── _authenticated/       # Authenticated pages
│   └── __root.tsx            # Root route
├── context/                   # Global Context Providers
│   ├── theme-provider.tsx    # Theme switching (dark/light)
│   ├── font-provider.tsx     # Font switching
│   ├── direction-provider.tsx # RTL support
│   └── layout-provider.tsx   # Layout configuration
├── stores/                    # Zustand state management
│   └── auth-store.ts
├── hooks/                     # Custom Hooks
│   └── use-table-url-state.tsx  # Table state sync with URL
├── lib/                       # Utility functions
└── main.tsx                   # Application entry point
```

### Route Structure

- **(auth)**: Sign in, sign up, forgot password, OTP verification
- **_authenticated**: Pages requiring authentication (dashboard, users, settings, etc.)
- **(errors)**: Error pages (401, 403, 404, 500)

### Shadcn UI Configuration

```json
{
  "style": "new-york",
  "baseColor": "slate",
  "cssVariables": true,
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui"
  }
}
```

### Important Conventions

1. **Path Aliases**: `@/*` maps to `src/*`
2. **Generated Files**: `src/routeTree.gen.ts` is auto-generated by TanStack Router, do not edit manually
3. **ESLint Ignores**: `src/components/ui/*` and `src/routeTree.gen.ts`
4. **Type Imports**: Strictly use `type` keyword for type imports
5. **No Console**: ESLint rules disable console statements

### Context Providers Order

Providers order in main.tsx:
```
ThemeProvider → FontProvider → DirectionProvider → RouterProvider
```

### Code Standards

- **Type Safety**: Strict TypeScript configuration
- **Code Style**: ESLint + Prettier
- **Unused Code**: Use Knip to analyze and clean up
- **Form Validation**: Use Zod schemas for validation

### Data Table Features

`src/components/data-table/` provides complete table functionality:
- Pagination
- Column sorting
- Multi-condition filtering
- Column show/hide
- Bulk actions
- URL state synchronization

### Theme System

- Dark/light mode switching
- RTL (Right-to-Left) layout support
- Multi-font switching
- CSS variable-driven styling

### Feature Module Structure

Each feature module follows standard structure:
```
features/[feature-name]/
├── index.tsx          # Route component
├── components/        # Feature-specific components
├── data/              # Mock data or API schema
│   ├── schema.ts      # Zod validation schema
│   └── data.ts        # Static/mock data
└── route.tsx          # Route definition
```

### Authentication & Error Handling

- **Auth State**: Zustand (`stores/auth-store.ts`) + Cookie persistence
- **Error Handling**:
  - 401: Redirect to sign-in page (with redirect URL)
  - 500: Navigate to /500 page in production
  - 304: Show "Content not modified" message

### Shadcn UI Component Update Notes

- **Generic Update Components**: scroll-area, sonner, separator
- **RTL Updated Components**: alert-dialog, calendar, command, dialog, dropdown-menu, select, table, sheet, sidebar, switch
- **Standard Components**: Can be safely updated via Shadcn CLI

### Custom Hooks

- `use-table-url-state.tsx`: Two-way sync between table state and URL query params
- `use-dialog-state.tsx`: Dialog state management
- `use-mobile.tsx`: Mobile device detection

### Utility Functions (lib/)

- `utils.ts`: `cn()` style merging, `getPageNumbers()` pagination generation
- `cookies.ts`: Cookie operations (replaces js-cookie)
- `handle-server-error.ts`: Unified error handling

## Docker Deployment

The project includes a Dockerfile for containerized deployment:

```bash
# Build image
docker build -t cheesepuff-admin:latest .

# Run container
docker run -p 8080:80 cheesepuff-admin:latest

# Build with API mock enabled
docker build --build-arg VITE_API_MOCK=true -t cheesepuff-admin:latest .
```

For detailed deployment instructions, see `docs/DEPLOYMENT.md`

## When to Create or Update CLAUDE.md

Create or Update a `CLAUDE.md` file in a folder when:

- A new folder is created for code organization (not for static assets or documentation)
- The folder structure changes (files added, removed, or renamed)
- The functionality of files in the folder needs clarification
- Working with an unfamiliar codebase that lacks documentation

**Skip for:** Documentation folders, static assets (images, fonts), test fixtures, or configuration-only directories.
